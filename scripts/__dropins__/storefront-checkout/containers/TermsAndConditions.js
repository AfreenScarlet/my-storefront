/*! Copyright 2025 Adobe
All Rights Reserved. */
import{jsx as e,jsxs as N}from"@dropins/tools/preact-jsx-runtime.js";/* empty css                          */import{classes as h,VComponent as S,Slot as z}from"@dropins/tools/lib.js";import{Skeleton as j,SkeletonRow as w,Checkbox as V}from"@dropins/tools/components.js";import{A as q}from"../chunks/checkout.js";import{events as f}from"@dropins/tools/event-bus.js";import{s as O}from"../chunks/state.js";import{useEffect as k}from"@dropins/tools/preact-compat.js";import{useState as i,useCallback as g}from"@dropins/tools/preact-hooks.js";import{useText as P,MarkupText as R}from"@dropins/tools/i18n.js";const U=({className:o,isInitialized:a=!1,agreements:r,error:s,...d})=>a?e("div",{className:"checkout-terms-and-conditions",children:N("form",{...d,className:h(["checkout-terms-and-conditions__form",o]),name:"checkout-terms-and-conditions","data-testid":"checkout-terms-and-conditions-form",noValidate:!0,children:[r&&e(S,{node:r,className:h(["checkout-terms-and-conditions__agreements"]),"data-testid":"checkout-terms-and-conditions-agreements"}),s&&e("div",{className:"checkout-terms-and-conditions__error","data-testid":"checkout-terms-and-conditions-error",children:s})]})}):e(W,{}),W=()=>e(j,{"data-testid":"checkout-terms-and-conditions-skeleton",className:"checkout-terms-and-conditions-skeleton",children:e(w,{variant:"row",size:"small",fullWidth:!0})}),Q=({slots:o,...a})=>{const[r,s]=i(!0),[d,p]=i(!1),[A,C]=i(!1),[_,c]=i(""),{errorMessage:m}=P({errorMessage:"Checkout.TermsAndConditions.error"}),x=g(()=>{c("")},[]),v=g(()=>{c(m)},[m]);return k(()=>{const t=f.on("checkout/initialized",()=>{var n;p(!0),s(((n=O.config)==null?void 0:n.isCheckoutAgreementsEnabled)??!0)},{eager:!0});return()=>{t==null||t.off()}},[]),k(()=>{const t=f.on("authenticated",n=>{C(n)},{eager:!0});return()=>{t==null||t.off()}},[]),!r||A?null:e("div",{"data-testid":"terms-and-conditions",children:e(U,{...a,error:_,isInitialized:d,agreements:e(z,{name:"Agreements",slot:o==null?void 0:o.Agreements,context:{appendAgreement(t){this._registerMethod((...n)=>{const l=t(...n);if(!l)return;const{mode:I,name:T,text:b,translationId:u}=l,E=e(V,{checked:I===q.AUTO,label:u?e(R,{id:u}):b,name:T,required:!0,onChange:x,onInvalid:v});this._setProps(M=>({children:[...M.children||[],E]}))})}}})})})};export{Q as TermsAndConditions,Q as default};
