import{jsxs as B,jsx as y,Fragment as ge}from"@dropins/tools/preact-jsx-runtime.js";import*as j from"@dropins/tools/preact-compat.js";import{useState as E,Children as T,useRef as ue,useMemo as _e,useEffect as S,useCallback as Z}from"@dropins/tools/preact-compat.js";import{debounce as ve,classes as L}from"@dropins/tools/lib.js";import{Button as de,Icon as Me}from"@dropins/tools/components.js";/* empty css     */import{useText as $}from"@dropins/tools/i18n.js";import{cloneElement as Ne}from"@dropins/tools/preact.js";const Ee=a=>j.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...a},j.createElement("path",{d:"M7.74512 9.87701L12.0001 14.132L16.2551 9.87701",stroke:"currentColor",strokeWidth:1.5,strokeLinecap:"square",strokeLinejoin:"round"})),we=a=>j.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...a},j.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M18.3599 5.64001L5.62988 18.37",stroke:"currentColor"}),j.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M18.3599 18.37L5.62988 5.64001",stroke:"currentColor"})),ke=24,be=16,oe=2,De="32";var Ce=(a=>(a[a.small=16]="small",a[a.medium=24]="medium",a[a.large=64]="large",a))(Ce||{});const He=({show:a=1,scrollbar:b=!1,peak:_=!1,arrows:u=!1,controls:s="dots",arrowsOnMainImage:M=!1,loop:r=!1,gap:f=null,direction:k="horizontal",width:H="100%",height:re="100%",defaultIndex:W=0,className:ne,children:P,thumbnails:R=null,isZoomed:F,...K})=>{const q=$("PDP.Carousel.label").label,U=$("PDP.Carousel.Slide.label").label,V=$("PDP.Carousel.Previous.label").label,J=$("PDP.Carousel.Next.label").label,se=$("PDP.Carousel.Controls.label").label,Q=$("PDP.Carousel.Controls.Button.label").label,[i,le]=E(()=>ye(a)),o=Math.ceil(T.count(P)/i),d=_?ke:0,m=f?Ce[f]:0,x=T.count(P)%i,[c,X]=E(r?W+1:W),D=ue([]),[Y,ae]=E(0),[I,Le]=E(0),he=_e(()=>T.toArray(R),[R]),v=_e(()=>{const e=T.toArray(P).reduce((t,n,l)=>l%i===0?[...t,[n]]:[...t.slice(0,-1),[...t[t.length-1],n]],[]);return!r||e.length===1?e:r&&T.count(P)%i===0?[e[o-1]].concat(e).concat([e[0],e[1]]):[T.toArray(P).slice(-i)].concat(e).concat([e[0],e[1]])},[P,i,o,r]),z=ue(null),pe=ue(null),g=s==="thumbnailsRow"||s==="thumbnailsColumn";S(()=>{const e=document.body,t=ve(()=>{var h,N;ae(((h=z.current)==null?void 0:h.offsetWidth)??0),Le(((N=z.current)==null?void 0:N.offsetHeight)??0);const l=window.innerWidth,p=ye(a,l);p!==i&&le(p)},50),n=new ResizeObserver(t);return n.observe(e),()=>{n.unobserve(e)}},[i,a]);const O=Z(e=>{const t=r?e-1:e,n=D==null?void 0:D.current[0],l=(n==null?void 0:n.offsetWidth)+be,p=(n==null?void 0:n.offsetHeight)+be,h=pe.current,N=s==="thumbnailsRow",ie=s==="thumbnailsColumn",A=N?h==null?void 0:h.offsetWidth:h==null?void 0:h.offsetHeight,C=N?l:p;(N||ie)&&A&&(C*(t+1)>A&&(h.style.scrollBehavior="smooth",N?h.scrollLeft=(t+oe)*C:h.scrollTop=(t+oe)*C),(N?h.scrollLeft:h.scrollTop)>C*t&&(h.style.scrollBehavior="smooth",N?h.scrollLeft=(t-oe)*C:h.scrollTop=(t-oe)*C))},[s,r]);S(()=>{O(c)},[c,O]);const w=Z((e,t,n)=>{g&&O(e);const l=z.current,p=d?l.offsetWidth-d:l.offsetWidth-d+m;if(!Array.from(l.querySelectorAll("[data-index]")).filter(A=>{const C=Number(A.getAttribute("data-index"));return!isNaN(C)&&C>-1})[e])return;if(n){const A=e===0?o:0,C=p*(o+(x||i)/i);if(l.scrollLeft>=0&&l.scrollLeft<p-5){w(1,!0);return}if(l.scrollLeft>C-p&&l.scrollLeft<=C){w(o,!0);return}l.style.scrollBehavior="auto",l.scrollLeft=A===0?0:C,w(A===0?1:o,!0);return}const ie=(l.offsetWidth-m)/i*v[e].length-d;l.style.scrollBehavior=t?"smooth":"auto",l.scrollLeft=v[e].length===i?p*e:p*(e-1)+ie},[m,o,d,i,x,v,O,s]),G=Z(()=>{if(r){const t=c-1;w(t,!0,c===1);return}const e=c<=0?0:c-1;w(e,!0)},[c,w,r]),ee=Z(()=>{const e=v.length-1;if(r){const n=c+1;w(n,!0,c===o);return}const t=c>=e?e:c+1;w(t,!0)},[v.length,r,c,w,o]);S(()=>{const e=t=>{t.key==="ArrowLeft"&&(t.preventDefault(),G()),t.key==="ArrowRight"&&(t.preventDefault(),ee())};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[ee,G]),S(()=>{w(r?W+1:W,!1)},[W,w,r]);const ce=ve(()=>{const e=z.current,t=d?e.offsetWidth-d:e.offsetWidth-d+m,n=e.scrollLeft/t,l=Math.round(n)-n<1?Math.round(n):Math.ceil(n);if(g&&O(l),r){const p=t*(o+(x||i)/i);if(Math.ceil(e.scrollLeft)>=Math.ceil(p)-5){e.style.scrollBehavior="auto",e.scrollLeft=e.offsetWidth*1+(Math.ceil(e.scrollLeft)-Math.ceil(p)-d);return}if(e.scrollLeft===0){e.style.scrollBehavior="auto",e.scrollLeft=p-e.offsetWidth+d;return}}c!==l&&X(l)},100);S(()=>{const e=z.current;return e==null||e.addEventListener("scroll",ce),()=>{e==null||e.removeEventListener("scroll",ce)}},[ce]);const te=(e,t,n)=>y(de,{className:L([["pdp-carousel__button",!e],[`pdp-carousel__button--${t}`,!e],[`pdp-carousel__button--${s}`,e]]),style:{"--height":`${I}px`},variant:"tertiary","aria-label":t==="next"?J:V,onClick:n,disabled:r?!1:t==="next"?c>=v.length-1:c<1,children:y(Me,{className:L([["pdp-carousel__button__icon",!e],[`pdp-carousel__button__icon--${t}`,!e],[`pdp-carousel__button__icon--${s}--${t}`,e]]),size:De,source:Ee})}),fe=u&&v.length!=1&&te(g,"prev",G),me=u&&v.length!=1&&te(g,"next",ee),xe=u&&v.length!=1&&te(!1,"prev",G),Pe=u&&v.length!=1&&te(!1,"next",ee);return B("div",{role:"region","aria-roledescription":q,className:L(["pdp-carousel",["pdp-carousel--main-image-controls",M],["pdp-carousel--arrows",u&&!g],[`pdp-carousel--${s}`,g],ne]),style:{"--flex-carousel":s==="thumbnailsColumn"?"row-reverse":"column","--gap":g?"0":"var(--spacing-small)","--width":H},...K,children:[y("div",{ref:z,className:L(["pdp-carousel__wrapper",`pdp-carousel__wrapper--${k}`,["pdp-carousel__wrapper--scrollbar",b],["pdp-carousel__wrapper--peak",_]]),style:{"--total-width":s==="thumbnailsColumn"?"81.6%":"100%","--height":s==="thumbnailsColumn"?"auto":re,"--gap":f?`var(--spacing-${f})`:"0px","--per-page":i},tabIndex:0,children:v.map((e,t)=>{const n=e.length<i;return y("div",{role:"group","aria-roledescription":U,"data-index":t,className:L(["pdp-carousel__slide",`pdp-carousel__slide--${k}`,["pdp-carousel__slide--active",c===t],["pdp-carousel__slide--orphan",n]]),style:{"--length":e.length},children:e},t)})}),!g&&B(ge,{children:[fe,me]}),g&&M&&B(ge,{children:[xe,Pe]}),s&&v.length!=1&&B("div",{className:L([[`pdp-carousel__controls__container--${s}`,g],["pdp-carousel__controls__container--no-arrows",!u||M]]),style:{"--width":s==="thumbnailsRow"?`${Y}px`:H,"--height":`${I}px`,"--nr-thumbnails":he.length},children:[(g||F)&&!M&&fe,y("div",{ref:pe,className:L([[`pdp-carousel__controls__wrapper--${s}`,g],["pdp-carousel__controls__wrapper",g]]),children:y("div",{role:"group","aria-label":se,className:L(["pdp-carousel__controls",[`pdp-carousel__controls--${s}`,g]]),children:(r?v.slice(0,o):v).map((e,t)=>{const n=r?o:v.length,l=r?c-1===t:c===t;return g?B("label",{className:L(["pdp-carousel__thumbnail__container"]),ref:p=>{p&&(D.current[t]=p)},children:[y("input",{type:"radio",name:"carousel-thumbnails","aria-label":Q.replace("{key}",String(t+1)).replace("{total}",String(n)),checked:l&&Y!==0,onChange:()=>{w(r?t+1:t,!0)},...K,className:L(["pdp-carousel__thumbnail",["pdp-carousel__thumbnail--selected",l&&Y!==0]])}),y("span",{className:L(["pdp-carousel__thumbnail__span"]),children:he[t]})]},t):y("button",{"aria-label":Q.replace("{key}",String(t+1)).replace("{total}",String(n)),onClick:()=>{w(r?t+1:t,!0)},className:L(["pdp-carousel__controls__button",["pdp-carousel__controls__button--active",l]])},t)})})}),(g||F)&&!M&&me]})]})};function ye(a,b=0){if(typeof a=="number")return a;const{small:_,medium:u,large:s}=a,r=[{breakpoint:1024,value:s},{breakpoint:786,value:u},{breakpoint:0,value:_}].find(({breakpoint:f})=>b>f);return r?r.value:_}const Re=({centered:a,onClose:b,className:_,children:u,...s})=>{const M=$("PDP.Overlay.Close.label").label,r=Z(()=>{b==null||b()},[b]);return S(()=>{const f=k=>{k.key==="Escape"&&r()};return document.addEventListener("keydown",f),()=>{document.removeEventListener("keydown",f)}},[r]),S(()=>{const f=document.scrollingElement,k=f.style.overflow;return f.style.overflow="hidden",()=>{f.style.overflow=k}},[]),B("div",{...s,className:L(["pdp-overlay",["pdp-overlay--centered",a],_]),children:[y("div",{className:"pdp-overlay__content",children:u}),y(de,{"aria-label":M,variant:"tertiary",className:"pdp-overlay__close-button",onClick:r,icon:y(we,{})})]})},Xe=({children:a,scale:b=2,closeButton:_=!0})=>{const[u,s]=E(!1),[M,r]=E("pdp-zoom"),[f,k]=E(!1),[H,re]=E({x:0,y:0}),[W,ne]=E({x:0,y:0}),[P,R]=E({x:0,y:0}),F=o=>{!u||o.type!=="touchstart"||(re({x:o.touches[0].clientX,y:o.touches[0].clientY}),ne({x:P.x,y:P.y}),k(!0))},K=o=>{var I;if(!f||o.type!=="touchmove")return;const d=(I=o.currentTarget)==null?void 0:I.getBoundingClientRect(),m=(100-100/b)/2,x=o.touches[0].clientX-H.x,c=o.touches[0].clientY-H.y,X=x*100/(d.width*b),D=c*100/(d.height*b),Y=W.x+X,ae=W.y+D;R({x:Math.max(-m,Math.min(Y,m))||0,y:Math.max(-m,Math.min(ae,m))||0}),o.preventDefault()},q=o=>{var D;const d=(D=o.currentTarget)==null?void 0:D.getBoundingClientRect(),m=(100-100/b)/2;let x;if("touches"in o)x=o.touches[0];else if(o instanceof MouseEvent)x=o;else return;const c=m-(x.clientX-d.left)/d.width*100,X=m-(x.clientY-d.top)/d.height*100;R({x:Math.max(-m,Math.min(c,m))||0,y:Math.max(-m,Math.min(X,m))||0})},U=o=>{if(!f){if(u){if(_&&"touches"in o){F(o);return}_||s(!1)}else s(!0),q(o);o.preventDefault()}},V=o=>{if(_&&"touches"in o){K(o);return}u&&q(o)},J=()=>{if(_){k(!1);return}s(!1)},se=o=>{s(!1),o.stopPropagation()},Q=u?`scale(${b}) translateX(${P.x}%) translateY(${P.y}%)`:"none",i=$("PDP.Zoom.Close.label").label,le=Ne(T.only(a),{draggable:!1,style:{"--transform":Q}});return S(()=>{r(u?`pdp-zoom ${_?"pdp-zoom--no-effects":"pdp-zoom--zoomed"}`:"pdp-zoom")},[u,_]),B("figure",{className:M,onClick:U,onMouseMove:V,onMouseLeave:J,onTouchStart:U,onTouchMove:V,onTouchEnd:J,children:[le,_&&u&&y(de,{"aria-label":i,variant:"tertiary",className:"pdp-zoom__close-button",icon:y(we,{}),onClick:se})]})};export{He as C,Re as O,Xe as Z};
