import*as pe from"@dropins/tools/preact-compat.js";import{useState as Z,Children as ce,useRef as Ae,useMemo as we,useEffect as re,useCallback as C}from"@dropins/tools/preact-compat.js";import{debounce as Le,classes as x,VComponent as U,toLanguageTag as Ne,Slot as G}from"@dropins/tools/lib.js";import{Button as Pe,Icon as ve,Price as Se,Picker as Ue,ColorSwatch as He,ImageSwatch as Ve,TextSwatch as ze,Incrementer as qe,Breadcrumbs as je,Image as De}from"@dropins/tools/components.js";import{jsxs as H,jsx as t,Fragment as fe}from"@dropins/tools/preact-jsx-runtime.js";import{useText as z}from"@dropins/tools/i18n.js";import{cloneElement as Ge}from"@dropins/tools/preact.js";import{c as Ie,d as $e}from"../chunks/getRefinedProduct.js";import{events as Fe}from"@dropins/tools/event-bus.js";import{c as Me}from"../chunks/initialize.js";import"@dropins/tools/fetch-graphql.js";const Ke=e=>pe.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},pe.createElement("path",{d:"M7.74512 9.87701L12.0001 14.132L16.2551 9.87701",stroke:"currentColor",strokeWidth:1.5,strokeLinecap:"square",strokeLinejoin:"round"})),Qe=e=>pe.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},pe.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M18.3599 5.64001L5.62988 18.37",stroke:"currentColor"}),pe.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M18.3599 18.37L5.62988 5.64001",stroke:"currentColor"})),Xe=24,ge=16,_e=2,Ze="32";var Oe=(e=>(e[e.small=16]="small",e[e.medium=24]="medium",e[e.large=64]="large",e))(Oe||{});const be=({show:e=1,scrollbar:d=!1,peak:h=!1,arrows:_=!1,controls:p="dots",arrowsOnMainImage:A=!1,loop:u=!1,gap:w=null,direction:l="horizontal",width:q="100%",height:c="100%",defaultIndex:m=0,className:E,children:I,thumbnails:F=null,isZoomed:S,...P})=>{const b=z("PDP.Carousel.label").label,r=z("PDP.Carousel.Slide.label").label,D=z("PDP.Carousel.Previous.label").label,B=z("PDP.Carousel.Next.label").label,N=z("PDP.Carousel.Controls.label").label,ee=z("PDP.Carousel.Controls.Button.label").label,[n,J]=Z(()=>ke(e)),$=Math.ceil(ce.count(I)/n),T=h?Xe:0,K=w?Oe[w]:0,Y=ce.count(I)%n,[v,ie]=Z(u?m+1:m),le=Ae([]),[ae,se]=Z(0),[te,he]=Z(0),oe=we(()=>ce.toArray(F),[F]),M=we(()=>{const a=ce.toArray(I).reduce((i,L,g)=>g%n===0?[...i,[L]]:[...i.slice(0,-1),[...i[i.length-1],L]],[]);return!u||a.length===1?a:u&&ce.count(I)%n===0?[a[$-1]].concat(a).concat([a[0],a[1]]):[ce.toArray(I).slice(-n)].concat(a).concat([a[0],a[1]])},[I,n,$,u]),j=Ae(null),V=Ae(null),k=p==="thumbnailsRow"||p==="thumbnailsColumn";re(()=>{const a=document.body,i=Le(()=>{var R,ne;se(((R=j.current)==null?void 0:R.offsetWidth)??0),he(((ne=j.current)==null?void 0:ne.offsetHeight)??0);const g=window.innerWidth,W=ke(e,g);W!==n&&J(W)},50),L=new ResizeObserver(i);return L.observe(a),()=>{L.unobserve(a)}},[n,e]);const o=C(a=>{const i=u?a-1:a,L=le==null?void 0:le.current[0],g=(L==null?void 0:L.offsetWidth)+ge,W=(L==null?void 0:L.offsetHeight)+ge,R=V.current,ne=p==="thumbnailsRow",ye=p==="thumbnailsColumn",de=ne?R==null?void 0:R.offsetWidth:R==null?void 0:R.offsetHeight,X=ne?g:W;(ne||ye)&&de&&(X*(i+1)>de&&(R.style.scrollBehavior="smooth",ne?R.scrollLeft=(i+_e)*X:R.scrollTop=(i+_e)*X),(ne?R.scrollLeft:R.scrollTop)>X*i&&(R.style.scrollBehavior="smooth",ne?R.scrollLeft=(i-_e)*X:R.scrollTop=(i-_e)*X))},[p,u]);re(()=>{o(v)},[v,o]);const s=C((a,i,L)=>{k&&o(a);const g=j.current,W=T?g.offsetWidth-T:g.offsetWidth-T+K;if(!Array.from(g.querySelectorAll("[data-index]")).filter(de=>{const X=Number(de.getAttribute("data-index"));return!isNaN(X)&&X>-1})[a])return;if(L){const de=a===0?$:0,X=W*($+(Y||n)/n);if(g.scrollLeft>=0&&g.scrollLeft<W-5){s(1,!0);return}if(g.scrollLeft>X-W&&g.scrollLeft<=X){s($,!0);return}g.style.scrollBehavior="auto",g.scrollLeft=de===0?0:X,s(de===0?1:$,!0);return}const ye=(g.offsetWidth-K)/n*M[a].length-T;g.style.scrollBehavior=i?"smooth":"auto",g.scrollLeft=M[a].length===n?W*a:W*(a-1)+ye},[K,$,T,n,Y,M,o,p]),y=C(()=>{if(u){const i=v-1;s(i,!0,v===1);return}const a=v<=0?0:v-1;s(a,!0)},[v,s,u]),f=C(()=>{const a=M.length-1;if(u){const L=v+1;s(L,!0,v===$);return}const i=v>=a?a:v+1;s(i,!0)},[M.length,u,v,s,$]);re(()=>{const a=i=>{i.key==="ArrowLeft"&&(i.preventDefault(),y()),i.key==="ArrowRight"&&(i.preventDefault(),f())};return window.addEventListener("keydown",a),()=>{window.removeEventListener("keydown",a)}},[f,y]),re(()=>{s(u?m+1:m,!1)},[m,s,u]);const O=Le(()=>{const a=j.current,i=T?a.offsetWidth-T:a.offsetWidth-T+K,L=a.scrollLeft/i,g=Math.round(L)-L<1?Math.round(L):Math.ceil(L);if(k&&o(g),u){const W=i*($+(Y||n)/n);if(Math.ceil(a.scrollLeft)>=Math.ceil(W)-5){a.style.scrollBehavior="auto",a.scrollLeft=a.offsetWidth*1+(Math.ceil(a.scrollLeft)-Math.ceil(W)-T);return}if(a.scrollLeft===0){a.style.scrollBehavior="auto",a.scrollLeft=W-a.offsetWidth+T;return}}v!==g&&ie(g)},100);re(()=>{const a=j.current;return a==null||a.addEventListener("scroll",O),()=>{a==null||a.removeEventListener("scroll",O)}},[O]);const Q=(a,i,L)=>t(Pe,{className:x([["pdp-carousel__button",!a],[`pdp-carousel__button--${i}`,!a],[`pdp-carousel__button--${p}`,a]]),style:{"--height":`${te}px`},variant:"tertiary","aria-label":i==="next"?B:D,onClick:L,disabled:u?!1:i==="next"?v>=M.length-1:v<1,children:t(ve,{className:x([["pdp-carousel__button__icon",!a],[`pdp-carousel__button__icon--${i}`,!a],[`pdp-carousel__button__icon--${p}--${i}`,a]]),size:Ze,source:Ke})}),ue=_&&M.length!=1&&Q(k,"prev",y),me=_&&M.length!=1&&Q(k,"next",f),Te=_&&M.length!=1&&Q(!1,"prev",y),We=_&&M.length!=1&&Q(!1,"next",f);return H("div",{role:"region","aria-roledescription":b,className:x(["pdp-carousel",["pdp-carousel--main-image-controls",A],["pdp-carousel--arrows",_&&!k],[`pdp-carousel--${p}`,k],E]),style:{"--flex-carousel":p==="thumbnailsColumn"?"row-reverse":"column","--gap":k?"0":"var(--spacing-small)","--width":q},...P,children:[t("div",{ref:j,className:x(["pdp-carousel__wrapper",`pdp-carousel__wrapper--${l}`,["pdp-carousel__wrapper--scrollbar",d],["pdp-carousel__wrapper--peak",h]]),style:{"--total-width":p==="thumbnailsColumn"?"81.6%":"100%","--height":p==="thumbnailsColumn"?"auto":c,"--gap":w?`var(--spacing-${w})`:"0px","--per-page":n},tabIndex:0,children:M.map((a,i)=>{const L=a.length<n;return t("div",{role:"group","aria-roledescription":r,"data-index":i,className:x(["pdp-carousel__slide",`pdp-carousel__slide--${l}`,["pdp-carousel__slide--active",v===i],["pdp-carousel__slide--orphan",L]]),style:{"--length":a.length},children:a},i)})}),!k&&H(fe,{children:[ue,me]}),k&&A&&H(fe,{children:[Te,We]}),p&&M.length!=1&&H("div",{className:x([[`pdp-carousel__controls__container--${p}`,k],["pdp-carousel__controls__container--no-arrows",!_||A]]),style:{"--width":p==="thumbnailsRow"?`${ae}px`:q,"--height":`${te}px`,"--nr-thumbnails":oe.length},children:[(k||S)&&!A&&ue,t("div",{ref:V,className:x([[`pdp-carousel__controls__wrapper--${p}`,k],["pdp-carousel__controls__wrapper",k]]),children:t("div",{role:"group","aria-label":N,className:x(["pdp-carousel__controls",[`pdp-carousel__controls--${p}`,k]]),children:(u?M.slice(0,$):M).map((a,i)=>{const L=u?$:M.length,g=u?v-1===i:v===i;return k?H("label",{className:x(["pdp-carousel__thumbnail__container"]),ref:W=>{W&&(le.current[i]=W)},children:[t("input",{type:"radio",name:"carousel-thumbnails","aria-label":ee.replace("{key}",String(i+1)).replace("{total}",String(L)),checked:g&&ae!==0,onChange:()=>{s(u?i+1:i,!0)},...P,className:x(["pdp-carousel__thumbnail",["pdp-carousel__thumbnail--selected",g&&ae!==0]])}),t("span",{className:x(["pdp-carousel__thumbnail__span"]),children:oe[i]})]},i):t("button",{"aria-label":ee.replace("{key}",String(i+1)).replace("{total}",String(L)),onClick:()=>{s(u?i+1:i,!0)},className:x(["pdp-carousel__controls__button",["pdp-carousel__controls__button--active",g]])},i)})})}),(k||S)&&!A&&me]})]})};function ke(e,d=0){if(typeof e=="number")return e;const{small:h,medium:_,large:p}=e,u=[{breakpoint:1024,value:p},{breakpoint:786,value:_},{breakpoint:0,value:h}].find(({breakpoint:w})=>d>w);return u?u.value:h}const Ye=({title:e,breadcrumbs:d,galleryContent:h,infoContent:_,productContent:p,sku:A,outOfStock:u,shortDescription:w,description:l,attributes:q,images:c,options:m,price:E,specialPrice:I,className:F,children:S,quantity:P,actions:b,carouselConfig:r,zoomType:D="zoom",...B})=>{var v,ie,le,ae,se,te,he,oe,M;const N=z("PDP.Product.RegularPrice.label").label,ee=z("PDP.Product.SpecialPrice.label").label,n=z("PDP.Product.OutOfStock.label").label,J=z("PDP.Product.Image.label").label,[$,T]=Z(null),K=c!=null&&c.length?c.map((j,V)=>{var o;const k=(o=e==null?void 0:e.props)!=null&&o.children?J==null?void 0:J.replace("{product}",e.props.children.toString()).replace("{key}",String(V+1)).replace("{total}",String(c.length)):void 0;return D==="zoom"?t(rt,{children:t(U,{node:j,loading:V===0?"eager":"lazy",alt:k},V)}):t(U,{node:j,loading:V===0?"eager":"lazy",alt:k,onClick:()=>T(V)},V)}):t("img",{src:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",className:"pdp-product__images__placeholder","aria-hidden":!0}),Y=(v=r==null?void 0:r.thumbnails)!=null&&v.length?r.thumbnails.map((j,V)=>{var k;return t(U,{node:j,loading:(r==null?void 0:r.thumbnailsLoadingMode)||"lazy",alt:((k=e==null?void 0:e.props)==null?void 0:k.children)&&(J==null?void 0:J.replace("{product}",e.props.children.toString()).replace("{key}",String(V+1)).replace("{total}",String(c.length)))},V)}):t("img",{src:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",className:"pdp-product__images__placeholder","aria-hidden":!0});return H("div",{...B,className:x(["pdp-product",F]),children:[d&&t(U,{node:d,className:"pdp-product__breadcrumbs"}),H("div",{className:"pdp-product__column-container pdp-product__gallery-column",children:[t("div",{className:"pdp-product__column-body",children:(ie=r==null?void 0:r.controls)!=null&&ie.desktop?t(be,{className:"pdp-product__overlay__carousel",arrows:(c==null?void 0:c.length)>1,controls:(c==null?void 0:c.length)>1?r.controls.desktop:"dots",arrowsOnMainImage:r==null?void 0:r.arrowsOnMainImage,loop:(r==null?void 0:r.loopable)&&(c==null?void 0:c.length)>1,peak:((le=r==null?void 0:r.thumbnails)==null?void 0:le.length)>1&&((ae=r==null?void 0:r.peak)==null?void 0:ae.desktop)||!1,gap:(r==null?void 0:r.gap)||null,width:"100%",height:"100%",defaultIndex:$||0,thumbnails:Y,children:K}):t(Je,{className:"pdp-product__images",gap:"small",children:K})}),h&&t(U,{node:h,className:"pdp-product__gallery-content"})]}),H("div",{className:"pdp-product__column-container pdp-product__content-column",children:[H("div",{className:"pdp-product__column-body",children:[H("div",{className:"pdp-product__header",children:[e&&t(U,{node:e,className:"pdp-product__title"}),A&&t(U,{node:A,className:"pdp-product__sku"})]}),H("div",{className:"pdp-product__prices",children:[I&&t(U,{node:I,className:x(["pdp-product__price-special","pdp-product__price"]),"aria-label":ee,role:"text"}),E&&t(U,{node:E,className:x(["pdp-product__price-regular","pdp-product__price--grey"]),"aria-label":N,role:"text"})]}),(se=r==null?void 0:r.controls)!=null&&se.mobile&&((te=r==null?void 0:r.controls)==null?void 0:te.mobile)==="thumbnailsRow"?t(be,{className:"pdp-product__images pdp-product__images--carousel pdp-product__images--carousel--thumbnails",width:"100%",height:"auto",arrows:(c==null?void 0:c.length)>1,controls:(c==null?void 0:c.length)>1?"thumbnailsRow":null,loop:(r==null?void 0:r.loopable)&&(c==null?void 0:c.length)>1,peak:((he=r==null?void 0:r.thumbnails)==null?void 0:he.length)>1&&((oe=r==null?void 0:r.peak)==null?void 0:oe.mobile)||!1,gap:(r==null?void 0:r.gap)||null,thumbnails:Y,children:K}):t(be,{className:"pdp-product__images pdp-product__images--carousel",peak:((M=r==null?void 0:r.peak)==null?void 0:M.mobile)&&(c==null?void 0:c.length)>1,gap:(r==null?void 0:r.gap)||null,width:"100%",height:"auto",arrows:(c==null?void 0:c.length)>1,controls:(c==null?void 0:c.length)>1?"dots":null,loop:(r==null?void 0:r.loopable)&&(c==null?void 0:c.length)>1,children:K}),H("div",{className:x(["pdp-product__actions",["pdp-product__actions--out-of-stock",u]]),children:[u&&t("div",{className:"pdp-product__out-of-stock__text",children:n}),m&&t(U,{node:m,className:x(["pdp-product__options"])}),P&&t("div",{className:"pdp-product__quantity",children:t(U,{node:P})}),b&&t(U,{node:b,className:x(["pdp-product__buttons"])})]}),w&&t(U,{node:w,className:x(["pdp-product__short_description"])}),l&&t(U,{node:l,className:x(["pdp-product__description"])}),q?t("div",{className:"pdp-product__attributes",children:q}):null]}),_&&t(U,{node:_,className:"pdp-product__info-content"})]}),p&&t(U,{node:p,className:"pdp-product__content"}),$===null?null:t(Ce,{className:"pdp-product__overlay",onClose:()=>T(null),centered:!0,children:t(be,{className:"pdp-product__overlay__carousel",arrows:(c==null?void 0:c.length)>1,width:"100%",height:"100%",defaultIndex:$||0,loop:(r==null?void 0:r.loopable)&&(c==null?void 0:c.length)>1,controls:(c==null?void 0:c.length)>1?"dots":null,isZoomed:!0,children:K})})]})},Je=({children:e,gap:d=null,className:h,style:_,...p})=>{const A=ce.count(e);return t("div",{...p,className:x(["pdp-gallery-grid",h]),style:{"--gap":d?`var(--spacing-${d})`:"0px",..._},children:ce.map(e,(u,w)=>t("div",{className:"pdp-gallery-grid__item",children:t(U,{node:u,loading:w===0?"eager":"lazy"},u.props.src)},A+w))})},xe=({amount:e,currency:d,locale:h,variant:_,sale:p,minimumAmount:A,maximumAmount:u,className:w,...l})=>t(fe,{children:e||A===u?t("div",{className:"pdp-price-range",...l,children:t(Se,{amount:e||A,currency:d,locale:h,variant:_,sale:p,className:w})}):H("div",{className:"pdp-price-range",...l,children:[t(Se,{amount:A,currency:d,locale:h,className:w}),t("span",{className:"pdp-price-range__label",children:"-"}),t(Se,{amount:u,currency:d,locale:h,className:w})]})}),Ce=({centered:e,onClose:d,className:h,children:_,...p})=>{const A=z("PDP.Overlay.Close.label").label,u=C(()=>{d==null||d()},[d]);return re(()=>{const w=l=>{l.key==="Escape"&&u()};return document.addEventListener("keydown",w),()=>{document.removeEventListener("keydown",w)}},[u]),re(()=>{const w=document.scrollingElement,l=w.style.overflow;return w.style.overflow="hidden",()=>{w.style.overflow=l}},[]),H("div",{...p,className:x(["pdp-overlay",["pdp-overlay--centered",e],h]),children:[t("div",{className:"pdp-overlay__content",children:_}),t(Pe,{"aria-label":A,variant:"tertiary",className:"pdp-overlay__close-button",onClick:u,icon:t(Qe,{})})]})},et=["text","image","color","dropdown"],tt=e=>e.map(d=>({...d,text:d.label,disabled:!d.inStock})),nt=({options:e,hideSelectedValue:d,onValues:h,onErrors:_,defaultOptions:p,selectionsToUpdate:A,className:u,children:w,...l})=>{const q=z("PDP.Swatches.Required.label").label,[c,m]=Z(()=>e==null?void 0:e.reduce((P,b)=>{const{items:r}=b,D=r==null?void 0:r.find(N=>p==null?void 0:p.includes(N.id)),B=r==null?void 0:r.find(N=>N.selected);return D?{...P,[b.id]:{label:D.label,value:D.id}}:B?{...P,[b.id]:{label:B.label,value:B.id}}:P},{}));re(()=>{A==null||A.forEach(S=>{m(P=>{var D;const b=(D=S==null?void 0:S.items)==null?void 0:D.find(B=>B.selected);return b?{...P,[S.id]:{label:b==null?void 0:b.label,value:b==null?void 0:b.id}}:P})})},[A,m]),we(()=>{const S=e==null?void 0:e.reduce((P,b)=>{var r;return(r=b==null?void 0:b.items)==null||r.forEach(D=>{var N;const B=((N=c[b.id])==null?void 0:N.value)===D.id;b.required&&!B&&(P[b.id]=q)}),P},{});return _==null||_(S),S},[c]);const E=C((S,P,b)=>{m(r=>{const D={...r,[S]:{label:P,value:b}};return h==null||h(D,b),D})},[h]),I=(S,P)=>{var r;const b=((r=P.selectedOptions[0])==null?void 0:r.label)??"";E(S,b,P.value)},F=C(({items:S,id:P,required:b,type:r,selected:D,label:B})=>t("div",{className:x(["pdp-swatches__options"]),children:(r==null?void 0:r.toLowerCase())==="dropdown"?t(Ue,{"aria-label":B,handleSelect:N=>I(P,N.target),options:tt(S),value:D}):S==null?void 0:S.map(N=>{const ee={key:N.id,id:N.id,name:P,value:N.value,label:N.label,groupAriaLabel:B,selected:D===N.id,outOfStock:!N.inStock,required:b===null?!0:b,onValue:()=>{E(P,N.label,N.id)}};switch(r){case"text":return t(ze,{...ee,label:N.label});case"image":return t(Ve,{...ee,src:N.value,alt:N.label});case"color":return t(He,{...ee,size:"large",color:N.value});default:return console.warn(`Invalid swatch type ${r}`),null}})}),[E]);return t("div",{...l,className:x(["pdp-swatches",u]),children:e==null?void 0:e.map(({type:S,label:P,id:b,multiple:r,required:D,items:B})=>{var N;if(!S){console.warn("Bundle product not supported on UI.");return}return et.includes(S)||console.warn(`Invalid swatch type ${S}`),r&&console.warn("Multiple selection swatches are not currently supported."),H("div",{id:`swatch-item-${b}`,"data-slot-key":`product-swatch--${b}`,className:"pdp-swatches__field",children:[t("div",{className:"pdp-swatches__field__label",children:c[b]?d?`${P}`:`${P}: ${c[b].label}`:P}),t(F,{id:b,type:S,required:D,items:B,label:P,selected:(N=c[b])==null?void 0:N.value})]},`swatch-item-${b}`)})})},rt=({children:e,scale:d=2})=>{const[h,_]=Z(!1),[p,A]=Z({x:"0%",y:"0%"}),u=m=>{var b;const E=(b=m.currentTarget)==null?void 0:b.getBoundingClientRect(),I=(100-100/d)/2,F=m.type==="touchmove"?m.touches[0]:m,S=I-(F.clientX-E.x)/E.width*100,P=I-(F.clientY-E.y)/E.height*100;A({x:`${Math.max(-I,Math.min(S,I))||0}%`,y:`${Math.max(-I,Math.min(P,I))||0}%`})},w=m=>{h?_(!1):(_(!0),u(m))},l=m=>{h&&u(m)},q=()=>{_(!1)},c=h?`scale(${d}) translateX(${p.x}) translateY(${p.y})`:"none";return t("figure",{className:"pdp-zoom",onClick:w,onMouseMove:l,onMouseLeave:q,onTouchStart:w,onTouchMove:l,onTouchEnd:q,children:Ge(ce.only(e),{style:{"-webkit-transform":c,"-moz-transform":c,"-ms-transform":c,"-o-transform":c,transform:c}})})};function lt(e,d="en_US"){if(!Be(e))throw Error("Invalid date string");return e.split(" ")[1]||(e=`${e} 00:00:00`),new Date(e).toLocaleDateString(Ne(d)).toString()}function Be(e){if(![/^\d{4}-\d{2}-\d{2}$/,/^\d{1,2}\/\d{1,2}\/\d{4}$/,/^\d{2}\/\d{2}\/\d{4}$/,/^\d{4}\/\d{2}\/\d{2}$/,/^\d{1,2}\.\d{1,2}\.\d{4}$/,/^\d{4}-\d{2}-\d{2} \d{2}:\d{2}:\d{2}$/].some(_=>_.test(e)))return!1;const h=new Date(e);return!isNaN(h.getTime())}function ct(e){const d=new URLSearchParams(window.location.search);Object.entries(e).forEach(([_,p])=>{p===null?d.delete(_):d.set(_,String(p))});let h=window.location.pathname;h+=`?${d.toString()}`,h+=window.location.hash,window.history.replaceState({},"",h)}function at(){const e=new URLSearchParams(window.location.search),d={};return e.forEach((h,_)=>{d[_]=h}),d}function ot(e){var d,h,_,p,A,u,w,l,q,c,m,E;return{productId:Number(e==null?void 0:e.externalId),name:e==null?void 0:e.name,sku:e==null?void 0:e.sku,topLevelSku:e==null?void 0:e.externalParentId,specialToDate:void 0,specialFromDate:void 0,newToDate:void 0,newFromDate:void 0,createdAt:void 0,updatedAt:void 0,manufacturer:void 0,countryOfManufacture:void 0,categories:void 0,productType:void 0,pricing:{regularPrice:((h=(d=e==null?void 0:e.prices)==null?void 0:d.regular)==null?void 0:h.amount)||0,minimalPrice:(p=(_=e==null?void 0:e.prices)==null?void 0:_.final)==null?void 0:p.minimumAmount,maximalPrice:(u=(A=e==null?void 0:e.prices)==null?void 0:A.final)==null?void 0:u.maximumAmount,specialPrice:(l=(w=e==null?void 0:e.prices)==null?void 0:w.final)==null?void 0:l.amount,tierPricing:void 0,currencyCode:((c=(q=e==null?void 0:e.prices)==null?void 0:q.final)==null?void 0:c.currency)||"USD"},canonicalUrl:e==null?void 0:e.url,mainImageUrl:(E=(m=e==null?void 0:e.images)==null?void 0:m[0])==null?void 0:E.url}}const dt={PRODUCT_CONTEXT:"productContext"},it={PRODUCT_PAGE_VIEW:"product-page-view"};function Re(){return window.adobeDataLayer=window.adobeDataLayer||[],window.adobeDataLayer}function st(e,d){const h=Re();h.push({[e]:null}),h.push({[e]:d})}function ht(e,d){Re().push(_=>{const p=_.getState?_.getState():{};_.push({event:e,eventInfo:{...p,...d}})})}function Ee(e){const d=ot(e);st(dt.PRODUCT_CONTEXT,d),ht(it.PRODUCT_PAGE_VIEW)}const pt=({sku:e,hideSku:d,hideQuantity:h,hideShortDescription:_,hideDescription:p,hideAttributes:A,hideURLParams:u,hideSelectedOptionValue:w,slots:l,children:q,initialData:c,carousel:m,optionsConfig:E,useACDL:I,onAddToCart:F,...S})=>{var M,j,V,k;const P=z("PDP.Product.AddToCart.label").label,b=z("PDP.Product.Incrementer.label").label,r=z("PDP.Product.Details.label").label,[D,B]=Z(Me.getConfig().defaultLocale||"en-US"),[N,ee]=Z(),[n=null,J]=Z(c),[$,T]=Z(()=>{const o={sku:e,quantity:1};return n!=null&&n.optionUIDs&&(o.optionsUIDs=n.optionUIDs),o}),[K,Y]=Z(()=>{var o,s;return!(n!=null&&n.options&&((o=n==null?void 0:n.options)==null?void 0:o.length)>0&&((s=n==null?void 0:n.optionUIDs)==null?void 0:s.length)!==(n==null?void 0:n.options.length))}),v={data:n,values:$,valid:K};re(()=>{const o=Fe.on("locale",s=>{s!==D&&(B(s),Ie(e).then(J))});return()=>{o==null||o.off()}},[D,e]),re(()=>{I&&c&&Object.keys(c).length>0&&Ee(c)},[c]);const ie=C(o=>{T(s=>({...s,...o}))},[]),le=C(o=>{var y;let s=Object.keys(o).map(f=>o[f].value).filter(f=>f!==void 0);u||ct({optionsUIDs:s.join(",")}),T(f=>({...f,optionsUIDs:s})),Y((s==null?void 0:s.length)===((y=n==null?void 0:n.options)==null?void 0:y.length)),$e(e,s,E==null?void 0:E.anchorOptions).then(f=>{var O;J(f),(O=E==null?void 0:E.anchorOptions)!=null&&O.length&&ae(f,s),I&&(f==null?void 0:f.sku)!==e&&Ee(f)})},[e]),ae=C((o,s)=>{var O;const y=(o==null?void 0:o.optionUIDs)??[];s.every(Q=>y.includes(Q))||(ee(o==null?void 0:o.options),T(Q=>({...Q,optionsUIDs:y})),Y((y==null?void 0:y.length)===((O=o==null?void 0:o.options)==null?void 0:O.length)))},[e]),se=C(o=>{Object.keys(o).length!==0&&Y(!1)},[]),te=we(()=>{var o;return(o=n==null?void 0:n.attributes)==null?void 0:o.map(({label:s,value:y},f)=>{const O=Be(y)?lt(y,D):y.toString();return H("li",{children:[s,": ",t("span",{dangerouslySetInnerHTML:{__html:O}})]},f)})},[n==null?void 0:n.attributes,D]),he=!h&&(n!=null&&n.inStock)?t(G,{name:"Quantity",slot:l==null?void 0:l.Quantity,context:{...v},children:t(qe,{name:"quantity",defaultValue:$.quantity.toString(),min:1,"aria-label":b,className:"pdp-product__quantity",onValue:o=>{ie({quantity:Number(o)})}},"quantity")}):void 0,oe=()=>{if(n!=null&&n.options)return t(G,{name:"Options",slot:l==null?void 0:l.Options,context:{...v},children:t(nt,{options:n.options,defaultOptions:$.optionsUIDs,selectionsToUpdate:N,hideSelectedValue:w,onValues:le,onErrors:se})})};return t("div",{...S,children:t(Ye,{title:t(G,{name:"Title",slot:l==null?void 0:l.Title,context:{...v},children:n==null?void 0:n.name}),sku:d?void 0:t(G,{name:"SKU",slot:l==null?void 0:l.SKU,context:{...v},children:n==null?void 0:n.sku}),options:oe(),breadcrumbs:(l==null?void 0:l.Breadcrumbs)&&t(G,{name:"Breadcrumbs",slot:l==null?void 0:l.Breadcrumbs,context:{...v,setSeparator(o){this._registerMethod((...s)=>{const y=o(...s),f=y&&t(ve,{source:y});this._setProps(O=>({...O,separator:f}))})},appendLink(o){this._registerMethod((...s)=>{const{text:y,...f}=o(...s),O=t("a",{...f,children:y});this._setProps(Q=>({...Q,categories:[...Q.categories||[],O]}))})},appendHTMLElement(o){this._registerMethod((...s)=>{const y=o(...s),f=this._htmlElementToVNode(y);this._setProps(O=>({...O,categories:[...O.categories||[],f]}))})}},render:({separator:o,categories:s})=>t(je,{separator:o,categories:s})}),quantity:he,actions:t(G,{name:"Actions",slot:l==null?void 0:l.Actions,context:{...v,appendButton(o){this._registerMethod((...s)=>{const y=o(...s);if(!y)return;const{text:f,icon:O,...Q}=y,ue=t(Pe,{type:"button",...Q,icon:O&&t(ve,{source:O}),children:f});this._setProps(me=>({children:[...me.children||[],ue]}))})}},children:!(l!=null&&l.Actions)&&t(Pe,{size:"medium",type:"submit",icon:t(ve,{source:"Cart"}),disabled:!(n!=null&&n.inStock)||!K,"aria-label":P,onClick:()=>F==null?void 0:F($),children:P})}),shortDescription:_?void 0:t(G,{name:"ShortDescription",slot:l==null?void 0:l.ShortDescription,context:{...v},children:t("div",{dangerouslySetInnerHTML:{__html:(n==null?void 0:n.shortDescription)??""}})}),description:p?void 0:t(G,{name:"Description",slot:l==null?void 0:l.Description,context:{...v},children:t("div",{dangerouslySetInnerHTML:{__html:(n==null?void 0:n.description)??""}})}),images:((M=n==null?void 0:n.images)==null?void 0:M.map(({label:o,url:s})=>{var y,f;return t(De,{title:o,alt:o,src:s,width:((y=m==null?void 0:m.imageParams)==null?void 0:y.width)??960,height:((f=m==null?void 0:m.imageParams)==null?void 0:f.height)??1191,params:(m==null?void 0:m.imageParams)??{width:960}},s)}))??[],specialPrice:(j=n==null?void 0:n.prices)!=null&&j.visible?t(G,{name:"SpecialPrice",slot:l==null?void 0:l.SpecialPrice,context:{...v},children:t(xe,{...n.prices.final,locale:Ne(D)})}):void 0,price:(V=n==null?void 0:n.prices)!=null&&V.visible&&n.prices.regular&&n.prices.final.amount!==(n==null?void 0:n.prices.regular.amount)?t(G,{name:"RegularPrice",slot:l==null?void 0:l.RegularPrice,context:{...v},children:t(xe,{...n.prices.regular,locale:Ne(D)})}):void 0,carouselConfig:{...m,thumbnails:m&&Object.keys(m).length?((k=n==null?void 0:n.images)==null?void 0:k.map(({label:o,url:s})=>{var y,f;return t(De,{title:o,alt:o,src:s,width:((y=m==null?void 0:m.thumbnailParams)==null?void 0:y.width)??200,height:((f=m==null?void 0:m.thumbnailParams)==null?void 0:f.height)??248,params:(m==null?void 0:m.thumbnailParams)??{width:200}},s)}))??[]:[]},outOfStock:!(n!=null&&n.inStock),attributes:A?void 0:t(G,{name:"Attributes",slot:l==null?void 0:l.Attributes,context:{...v},children:te!=null&&te.length?H(fe,{children:[r,t("ul",{children:te})]}):null}),galleryContent:(l==null?void 0:l.GalleryContent)&&t(G,{name:"GalleryContent",slot:l.GalleryContent,context:{...v}}),infoContent:(l==null?void 0:l.InfoContent)&&t(G,{name:"InfoContent",slot:l.InfoContent,context:{...v}}),productContent:(l==null?void 0:l.Content)&&t(G,{name:"Content",slot:l.Content,context:{...v}})})})};pt.getInitialData=async function({sku:e,optionsConfig:d}){var _,p,A,u,w,l;const h=((_=at().optionsUIDs)==null?void 0:_.split(","))||((l=(w=(u=(A=(p=Me)==null?void 0:p.getConfig())==null?void 0:A.models)==null?void 0:u.ProductDetails)==null?void 0:w.initialData)==null?void 0:l.optionsUIDs);return h!=null&&h.length?await $e(e,h,d==null?void 0:d.anchorOptions):await Ie(e)};export{pt as ProductDetails,pt as default};
