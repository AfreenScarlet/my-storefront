/*! Copyright 2024 Adobe
All Rights Reserved. */
var xe=Object.defineProperty;var je=(e,t,r)=>t in e?xe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var ie=(e,t,r)=>je(e,typeof t!="symbol"?t+"":t,r);import{g as Ae}from"./image-params-keymap.js";import{jsx as S}from"../preact-jsx-runtime.js";import{l as g,_ as ve,k as q,G as Me,B as se}from"./icons/Add.js";import{signal as ae}from"../signals.js";const Se=e=>e.reduce((r,n)=>{if(!n)return r;if(typeof n=="string"&&(r+=` ${n}`),Array.isArray(n)){const[s,c]=n;s&&c&&(r+=` ${s}`)}return r},"").trim();function $e(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Ee=function(t){return Pe(t)&&!De(t)};function Pe(e){return!!e&&typeof e=="object"}function De(e){var t=Object.prototype.toString.call(e);return t==="[object RegExp]"||t==="[object Date]"||Te(e)}var Ne=typeof Symbol=="function"&&Symbol.for,Ce=Ne?Symbol.for("react.element"):60103;function Te(e){return e.$$typeof===Ce}function Le(e){return Array.isArray(e)?[]:{}}function W(e,t){return t.clone!==!1&&t.isMergeableObject(e)?L(Le(e),e,t):e}function Fe(e,t,r){return e.concat(t).map(function(n){return W(n,r)})}function Ue(e,t){if(!t.customMerge)return L;var r=t.customMerge(e);return typeof r=="function"?r:L}function ke(e){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e).filter(function(t){return Object.propertyIsEnumerable.call(e,t)}):[]}function oe(e){return Object.keys(e).concat(ke(e))}function ye(e,t){try{return t in e}catch{return!1}}function qe(e,t){return ye(e,t)&&!(Object.hasOwnProperty.call(e,t)&&Object.propertyIsEnumerable.call(e,t))}function We(e,t,r){var n={};return r.isMergeableObject(e)&&oe(e).forEach(function(s){n[s]=W(e[s],r)}),oe(t).forEach(function(s){qe(e,s)||(ye(e,s)&&r.isMergeableObject(t[s])?n[s]=Ue(s,r)(e[s],t[s],r):n[s]=W(t[s],r))}),n}function L(e,t,r){r=r||{},r.arrayMerge=r.arrayMerge||Fe,r.isMergeableObject=r.isMergeableObject||Ee,r.cloneUnlessOtherwiseSpecified=W;var n=Array.isArray(t),s=Array.isArray(e),c=n===s;return c?n?r.arrayMerge(e,t,r):We(e,t,r):W(t,r)}L.all=function(t,r){if(!Array.isArray(t))throw new Error("first argument should be an array");return t.reduce(function(n,s){return L(n,s,r)},{})};var ze=L,Ve=ze;const nt=$e(Ve),it=(e,t)=>{let r;return function(...n){clearTimeout(r),r=setTimeout(()=>e.apply(this,n),t)}},le={medium:768,large:1024,xlarge:1366,xxlarge:1920},Ke=(e,t)=>{const[r,n]=e.split("?"),s=new URLSearchParams(n),c=Ae();let _={};return c&&Object.keys(c).length>0&&t?_=Object.entries(t).reduce((o,[y,b])=>{const O=c[y];return O&&(o[O]=b),o},{}):_={auto:"webp",quality:80,crop:!1,fit:"cover",...t},Object.entries(_).forEach(([o,y])=>{y!=null&&s.set(o,String(y))}),`${r}?${s.toString()}`},st=(e,t)=>{if(!e||!(t!=null&&t.width))return;const r=n=>Ke(e,{...n});return Object.entries(le).map(([,n])=>{const s=t.width*n/le.xxlarge;return`${r({...t,width:s})} ${n}w`}).join(`,
`)};var Ze=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|^--/i,be=/^(area|base|br|col|embed|hr|img|input|link|meta|param|source|track|wbr)$/,K=/[\s\n\\/='"\0<>]/,he=/^xlink:?./,Be=/["&<]/;function k(e){if(Be.test(e+="")===!1)return e;for(var t=0,r=0,n="",s="";r<e.length;r++){switch(e.charCodeAt(r)){case 34:s="&quot;";break;case 38:s="&amp;";break;case 60:s="&lt;";break;default:continue}r!==t&&(n+=e.slice(t,r)),n+=s,t=r+1}return r!==t&&(n+=e.slice(t,r)),n}var ce=function(e,t){return String(e).replace(/(\n+)/g,"$1"+(t||"	"))},ue=function(e,t,r){return String(e).length>40||String(e).indexOf(`
`)!==-1||String(e).indexOf("<")!==-1},fe={},Ge=/([A-Z])/g;function me(e){var t="";for(var r in e){var n=e[r];n!=null&&n!==""&&(t&&(t+=" "),t+=r[0]=="-"?r:fe[r]||(fe[r]=r.replace(Ge,"-$1").toLowerCase()),t=typeof n=="number"&&Ze.test(r)===!1?t+": "+n+"px;":t+": "+n+";")}return t||void 0}function ee(e,t){return Array.isArray(t)?t.reduce(ee,e):t!=null&&t!==!1&&e.push(t),e}function de(){this.__d=!0}function Oe(e,t){return{__v:e,context:t,props:e.props,setState:de,forceUpdate:de,__d:!0,__h:[]}}function Z(e,t){var r=e.contextType,n=r&&t[r.__c];return r!=null?n?n.props.value:r.__:t}var I=[];function F(e,t,r,n,s,c){if(e==null||typeof e=="boolean")return"";if(typeof e!="object")return typeof e=="function"?"":k(e);var _=r.pretty,o=_&&typeof _=="string"?_:"	";if(Array.isArray(e)){for(var y="",b=0;b<e.length;b++)_&&b>0&&(y+=`
`),y+=F(e[b],t,r,n,s,c);return y}if(e.constructor!==void 0)return"";var O,d=e.type,u=e.props,x=!1;if(typeof d=="function"){if(x=!0,!r.shallow||!n&&r.renderRootComponent!==!1){if(d===q){var m=[];return ee(m,e.props.children),F(m,t,r,r.shallowHighOrder!==!1,s,c)}var v,i=e.__c=Oe(e,t);g.__b&&g.__b(e);var N=g.__r;if(d.prototype&&typeof d.prototype.render=="function"){var $=Z(d,t);(i=e.__c=new d(u,$)).__v=e,i._dirty=i.__d=!0,i.props=u,i.state==null&&(i.state={}),i._nextState==null&&i.__s==null&&(i._nextState=i.__s=i.state),i.context=$,d.getDerivedStateFromProps?i.state=Object.assign({},i.state,d.getDerivedStateFromProps(i.props,i.state)):i.componentWillMount&&(i.componentWillMount(),i.state=i._nextState!==i.state?i._nextState:i.__s!==i.state?i.__s:i.state),N&&N(e),v=i.render(i.props,i.state,i.context)}else for(var P=Z(d,t),C=0;i.__d&&C++<25;)i.__d=!1,N&&N(e),v=d.call(e.__c,u,P);return i.getChildContext&&(t=Object.assign({},t,i.getChildContext())),g.diffed&&g.diffed(e),F(v,t,r,r.shallowHighOrder!==!1,s,c)}d=(O=d).displayName||O!==Function&&O.name||function(J){var Q=(Function.prototype.toString.call(J).match(/^\s*function\s+([^( ]+)/)||"")[1];if(!Q){for(var V=-1,R=I.length;R--;)if(I[R]===J){V=R;break}V<0&&(V=I.push(J)-1),Q="UnnamedComponent"+V}return Q}(O)}var j,w,p="<"+d;if(u){var h=Object.keys(u);r&&r.sortAttributes===!0&&h.sort();for(var E=0;E<h.length;E++){var a=h[E],f=u[a];if(a!=="children"){if(!K.test(a)&&(r&&r.allAttributes||a!=="key"&&a!=="ref"&&a!=="__self"&&a!=="__source")){if(a==="defaultValue")a="value";else if(a==="defaultChecked")a="checked";else if(a==="defaultSelected")a="selected";else if(a==="className"){if(u.class!==void 0)continue;a="class"}else s&&he.test(a)&&(a=a.toLowerCase().replace(/^xlink:?/,"xlink:"));if(a==="htmlFor"){if(u.for)continue;a="for"}a==="style"&&f&&typeof f=="object"&&(f=me(f)),a[0]==="a"&&a[1]==="r"&&typeof f=="boolean"&&(f=String(f));var l=r.attributeHook&&r.attributeHook(a,f,t,r,x);if(l||l==="")p+=l;else if(a==="dangerouslySetInnerHTML")w=f&&f.__html;else if(d==="textarea"&&a==="value")j=f;else if((f||f===0||f==="")&&typeof f!="function"){if(!(f!==!0&&f!==""||(f=a,r&&r.xml))){p=p+" "+a;continue}if(a==="value"){if(d==="select"){c=f;continue}d==="option"&&c==f&&u.selected===void 0&&(p+=" selected")}p=p+" "+a+'="'+k(f)+'"'}}}else j=f}}if(_){var A=p.replace(/\n\s*/," ");A===p||~A.indexOf(`
`)?_&&~p.indexOf(`
`)&&(p+=`
`):p=A}if(p+=">",K.test(d))throw new Error(d+" is not a valid HTML tag name in "+p);var T,we=be.test(d)||r.voidElements&&r.voidElements.test(d),M=[];if(w)_&&ue(w)&&(w=`
`+o+ce(w,o)),p+=w;else if(j!=null&&ee(T=[],j).length){for(var B=_&&~p.indexOf(`
`),re=!1,G=0;G<T.length;G++){var X=T[G];if(X!=null&&X!==!1){var D=F(X,t,r,!0,d==="svg"||d!=="foreignObject"&&s,c);if(_&&!B&&ue(D)&&(B=!0),D)if(_){var ne=D.length>0&&D[0]!="<";re&&ne?M[M.length-1]+=D:M.push(D),re=ne}else M.push(D)}}if(_&&B)for(var Y=M.length;Y--;)M[Y]=`
`+o+ce(M[Y],o)}if(M.length||w)p+=M.join("");else if(r&&r.xml)return p.substring(0,p.length-1)+" />";return!we||T||w?(_&&~p.indexOf(`
`)&&(p+=`
`),p=p+"</"+d+">"):p=p.replace(/>$/," />"),p}var Xe={shallow:!0};z.render=z;var Ye=function(e,t){return z(e,t,Xe)},pe=[];function z(e,t,r){t=t||{};var n=g.__s;g.__s=!0;var s,c=ve(q,null);return c.__k=[e],s=r&&(r.pretty||r.voidElements||r.sortAttributes||r.shallow||r.allAttributes||r.xml||r.attributeHook)?F(e,t,r):U(e,t,!1,void 0,c),g.__c&&g.__c(e,pe),g.__s=n,pe.length=0,s}function H(e){return e==null||typeof e=="boolean"?null:typeof e=="string"||typeof e=="number"||typeof e=="bigint"?ve(null,null,e):e}function Je(e,t){return e==="className"?"class":e==="htmlFor"?"for":e==="defaultValue"?"value":e==="defaultChecked"?"checked":e==="defaultSelected"?"selected":t&&he.test(e)?e.toLowerCase().replace(/^xlink:?/,"xlink:"):e}function Qe(e,t){return e==="style"&&t!=null&&typeof t=="object"?me(t):e[0]==="a"&&e[1]==="r"&&typeof t=="boolean"?String(t):t}var _e=Array.isArray,ge=Object.assign;function U(e,t,r,n,s){if(e==null||e===!0||e===!1||e==="")return"";if(typeof e!="object")return typeof e=="function"?"":k(e);if(_e(e)){var c="";s.__k=e;for(var _=0;_<e.length;_++)c+=U(e[_],t,r,n,s),e[_]=H(e[_]);return c}if(e.constructor!==void 0)return"";e.__=s,g.__b&&g.__b(e);var o=e.type,y=e.props;if(typeof o=="function"){var b;if(o===q)b=y.children;else{b=o.prototype&&typeof o.prototype.render=="function"?function(h,E){var a=h.type,f=Z(a,E),l=new a(h.props,f);h.__c=l,l.__v=h,l.__d=!0,l.props=h.props,l.state==null&&(l.state={}),l.__s==null&&(l.__s=l.state),l.context=f,a.getDerivedStateFromProps?l.state=ge({},l.state,a.getDerivedStateFromProps(l.props,l.state)):l.componentWillMount&&(l.componentWillMount(),l.state=l.__s!==l.state?l.__s:l.state);var A=g.__r;return A&&A(h),l.render(l.props,l.state,l.context)}(e,t):function(h,E){var a,f=Oe(h,E),l=Z(h.type,E);h.__c=f;for(var A=g.__r,T=0;f.__d&&T++<25;)f.__d=!1,A&&A(h),a=h.type.call(f,h.props,l);return a}(e,t);var O=e.__c;O.getChildContext&&(t=ge({},t,O.getChildContext()))}var d=U(b=b!=null&&b.type===q&&b.key==null?b.props.children:b,t,r,n,e);return g.diffed&&g.diffed(e),e.__=void 0,g.unmount&&g.unmount(e),d}var u,x,m="<";if(m+=o,y)for(var v in u=y.children,y){var i=y[v];if(!(v==="key"||v==="ref"||v==="__self"||v==="__source"||v==="children"||v==="className"&&"class"in y||v==="htmlFor"&&"for"in y||K.test(v))){if(i=Qe(v=Je(v,r),i),v==="dangerouslySetInnerHTML")x=i&&i.__html;else if(o==="textarea"&&v==="value")u=i;else if((i||i===0||i==="")&&typeof i!="function"){if(i===!0||i===""){i=v,m=m+" "+v;continue}if(v==="value"){if(o==="select"){n=i;continue}o!=="option"||n!=i||"selected"in y||(m+=" selected")}m=m+" "+v+'="'+k(i)+'"'}}}var N=m;if(m+=">",K.test(o))throw new Error(o+" is not a valid HTML tag name in "+m);var $="",P=!1;if(x)$+=x,P=!0;else if(typeof u=="string")$+=k(u),P=!0;else if(_e(u)){e.__k=u;for(var C=0;C<u.length;C++){var j=u[C];if(u[C]=H(j),j!=null&&j!==!1){var w=U(j,t,o==="svg"||o!=="foreignObject"&&r,n,e);w&&($+=w,P=!0)}}}else if(u!=null&&u!==!1&&u!==!0){e.__k=[H(u)];var p=U(u,t,o==="svg"||o!=="foreignObject"&&r,n,e);p&&($+=p,P=!0)}if(g.diffed&&g.diffed(e),e.__=void 0,g.unmount&&g.unmount(e),P)m+=$;else if(be.test(o))return N+" />";return m+"</"+o+">"}z.shallowRender=Ye;const Re=Me(null);class at{constructor(t){ie(this,"_provider");this._provider=t}render(t,r){return async n=>{var d;if(!t)throw new Error("Component is not defined");if(!n)throw new Error("Root element is not defined");const s=await((d=t.getInitialData)==null?void 0:d.call(t,r))??{},c=ae({...r}),_=ae(new Set),o=this._provider,y=({next:u})=>S(Re.Provider,{value:_,children:S(te,{node:o,...o.props,children:S(t,{...u.value,initialData:s})})});n.innerHTML="";const b=document.createElement("div");n.classList.add("dropin-design"),se(S(y,{next:c}),b);const O={remove:()=>{se(null,b)},setProps:u=>{const x=u(c.peek());c.value=x}};return new Promise(u=>{_.subscribe(x=>{if(x.size===0)return n.classList.add("dropin-design"),n.appendChild(b.firstChild??b),u(O)})})}}unmount(t){var r;if(!t)throw new Error("Root element is not defined");(r=t.firstChild)==null||r.remove()}async toString(t,r,n){var c;if(!t)throw new Error("Component is not defined");const s=await((c=t.getInitialData)==null?void 0:c.call(t,r))??{};return z(S(te,{node:this._provider,...this._provider.props,children:S(t,{...r,initialData:s})}),{},{...n})}}function te({node:e,...t}){return e?Array.isArray(e)?S(q,{children:e.map((r,n)=>S(te,{node:r,className:t.className,...t},n))}):(t.className=Se([e.props.className,t.className]),S(e.type,{ref:e.ref,...e.props,...t},e.key)):null}const ot=e=>typeof e=="number",lt=()=>{const e=["iPad","iPhone","iPod"],t="ontouchend"in document;if(navigator.userAgentData){const _=(navigator.userAgentData.brands||[]).some(o=>o.brand==="Apple");return e.some(o=>navigator.userAgentData.platform===o)||_&&t}const r=navigator.userAgent||"",n=e.some(c=>r.includes(c)),s=r.includes("Mac")&&t;return n||s};export{at as R,Re as S,te as V,it as a,lt as b,Se as c,nt as d,st as g,ot as i};
