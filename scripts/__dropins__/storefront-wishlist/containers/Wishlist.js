/*! Copyright 2025 Adobe
All Rights Reserved. */
import{jsx as s,jsxs as p}from"@dropins/tools/preact-jsx-runtime.js";import{useState as g,useEffect as S,useCallback as $,Fragment as T}from"@dropins/tools/preact-compat.js";import{classes as c,VComponent as f}from"@dropins/tools/lib.js";import{IllustratedMessage as j,Icon as A,Button as z,InLineAlert as B}from"@dropins/tools/components.js";import{W as C,S as F,a as V}from"../chunks/WishlistItem.js";import{a as q,S as G}from"../chunks/HeartFilled.js";import{useText as b,Text as I}from"@dropins/tools/i18n.js";import{events as _}from"@dropins/tools/event-bus.js";import{s as J}from"../chunks/removeProductsFromWishlist.js";import"@dropins/tools/fetch-graphql.js";const K=({className:a,children:u,ctaLinkURL:d,...i})=>{const l=b({emptyWishlist:"Wishlist.EmptyWishlist.heading",message:"Wishlist.EmptyWishlist.message",cta:"Wishlist.EmptyWishlist.cta"});return s("div",{...i,className:c(["wishlist-empty-wishlist",a]),children:s(j,{className:c(["wishlist-empty-wishlist__wrapper",a]),"data-testid":"wishlist-empty-wishlist",heading:l.emptyWishlist,icon:s(A,{className:"wishlist-empty-wishlist__icon",source:q}),message:s("p",{children:l.message}),action:d?s(z,{"data-testid":"wishlist-empty-wishlist-button",size:"medium",variant:"primary",type:"submit",href:d,children:l.cta},"routeHome"):void 0})})},O=({className:a,children:u,heading:d,emptyWishlist:i,products:l,wishlistAlert:h,...w})=>{const[n,m]=g(h);S(()=>{if(h){m(h);const v=setTimeout(()=>{m(null)},5e3);return()=>clearTimeout(v)}},[h]);const W=n?s(f,{node:n,className:"wishlist-wishlist__alert"}):null;return p("div",{...w,className:c(["wishlist-wishlist",a]),children:[W,l&&d&&s("div",{"data-testid":"wishlist-heading-wrapper",className:c(["wishlist-wishlist__heading"]),children:s(f,{node:d,className:"wishlist-wishlist__heading-text"})}),s("div",{className:c(["wishlist-wishlist__content",["wishlist-wishlist__content--empty",!l]]),children:l||s(f,{node:i})})]})},Q=()=>p("div",{className:"wishlist-login__sign-in",children:[s("a",{"data-testid":"log-in-link",className:"wishlist-login__link",href:"/#",target:"_blank",rel:"noreferrer",children:s(I,{id:"Wishlist.Login.logIn"})}),s(I,{id:"Wishlist.Login.sync"})]}),es=({routeEmptyWishlistCTA:a,moveProdToCart:u,...d})=>{var N,H;const[i,l]=g(null),[h,w]=g(J.authenticated),n=b({wishlistHeading:"Wishlist.Wishlist.heading",addHeading:"Wishlist.Alert.addProduct.heading",addMessage:"Wishlist.Alert.addProduct.message",removeHeading:"Wishlist.Alert.removeProduct.heading",removeMessage:"Wishlist.Alert.removeProduct.message",moveHeading:"Wishlist.Alert.moveToCart.heading",moveMessage:"Wishlist.Alert.moveToCart.message",viewWishlist:"Wishlist.Alert.viewWishlist"}),m=e=>w(e),[W,v]=g(null),y=$(e=>{const{action:t,item:o}=e,r=n[`${t}Heading`],P=n[`${t}Message`],x={add:G,remove:F,move:V};v(s(B,{"data-testid":"wishlist-alert",heading:r,description:P.replace("{product}",o.product.name),type:"success",icon:s(A,{source:x[t],size:"16"}),actionButtonPosition:"top",additionalActions:[{label:n.viewWishlist,onClick:()=>{}}]}))},[n]);S(()=>{const e=_.on("authenticated",m),t=_.on("wishlist/update",r=>y(r)),o=_.on("wishlist/data",async r=>{l(r)},{eager:!0});return()=>{e==null||e.off(),o==null||o.off(),t==null||t.off()}},[y]);const k=p("div",{children:[s(K,{"data-testid":"empty-wishlist",ctaLinkURL:a==null?void 0:a()}),!h&&s(Q,{})]}),L=s("div",{"data-testid":"default-wishlist-heading",children:(N=n.wishlistHeading)==null?void 0:N.split(" {count}").map((e,t)=>{var o,r;return p(T,{children:[e,t===0&&s("span",{className:"wishlist-wishlist__heading-count",children:` ${(o=i==null?void 0:i.items)==null?void 0:o.length} products`})]},((r=i==null?void 0:i.id)==null?void 0:r.toString())+t)})}),M=((H=i==null?void 0:i.items)==null?void 0:H.length)>0?i.items.map(e=>{var t;return s(C,{initialData:e,moveProdToCart:u},(t=e.product)==null?void 0:t.sku)}):null;return s(O,{...d,heading:L,emptyWishlist:k,products:M,wishlistAlert:W})};export{es as Wishlist,es as default};
